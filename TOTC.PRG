SET STAT OFF
SET TALK OFF
RELE ALL
STORE 'S' TO ANC
DO WHIL ANC = 'S'
CLEAR
STORE 'S' TO ANC
@  1,  3  SAY "CALCOLO VALORI INVENTARIO-ACQUISTI-TOTALE-VENDUTO-RIMANENZE SU INVENTARI"
@  4, 22  SAY "VUOI USARE IL MAGAZZINO DELL'ANNO"
@  5, 22  SAY "---------------------------------"
@  0,  1  TO  2, 77    DOUBLE
@  6,  8  TO  8, 21  
@  6, 47  TO  8, 60  
SET MESSAGE TO 24
@  7, 11   PROMPT "IN CORSO";
 MESSAGE "EFFUTTUA I CALCOLI SUL MAGAZZINO DELL'ANNO CORRENTE"
@  7, 49   PROMPT "PRECEDENTE";
 MESSAGE "EFFETTUA I CALCOLI SUL MAGAZZINO DELL'ANNO PRECEDENTE"              
MENU TO SCE
DO CASE
 CASE SCE= 1
 INV="ARKIVIO"
 CASE SCE= 2
 INV="ARKIVOLD"
ENDCASE
@ 10, 23 SAY "INTRODUCI IL NOME DELLA DITTA"
@  9, 22 TO 12, 53
STORE '   ' TO VPRD
@ 11, 36 GET VPRD
READ
IF VPRD='   '
RETURN
ENDIF
USE ANAGRAF INDEX CODISTR
    SEEK VPRD
IF EOF()
LOOP
ENDIF
STORE ANAGRAF->NOME TO VNOM
@ 13, 28 SAY VNOM
@ 14, 30 SAY "GIUSTO ?"
VARS='S'
@ 14, 41 GET VARS
@ 16, 23 SAY "CATEGORIA ?" 
STORE "   " TO VCAT
@ 16, 36 GET VCAT
READ
IF VARS ='N'
LOOP
ENDIF
@ 4, 0 CLEAR
SET ECHO OFF
*   SET COLOR TO W+/ ,G+*/GR
@ 10,20 SAY "ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ"
@ 11,20 SAY "ณ"
*ET COLOR TO W+*/ 
@ 11,21 SAY "TRA 25 SECONDI LA RISPOSTA .. GRAZIE"
*SET COLOR TO W+/ 
@ 11,57 SAY "ณ"
@ 12,20 SAY "ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู"
*SET COLOR TO W+/ , /W
*  SET COLOR TO 15/0, 0/7
USE TOT
SET SAFE OFF
ZAP
SET SAFE ON
APPEND FROM &INV FOR PRD=VPRD .AND. CAT=VCAT
SUM COSTO * GIACONT  TO V4
SUM COSTO * PROGCAR  TO V1
SUM COSTO * PROGSCA  TO V2
SUM COSTO * GIADIN   TO V3
STORE V4+V1 TO V5
STORE (V2 * 100)/V5 TO V7
STORE (V3 * 100)/V5 TO V8
*** MAS ***
@ 0,0 CLEAR
@ 8,19 SAY  "ษอออออออออออออหอออออออออป"
@ 9,19 SAY  "บ INVENTARIO  บ         บ"
@ 10,19 SAY "ฬอออออออออออออฮอออออออออน"
@ 11,19 SAY "บ ACQUISTATO  บ         บ"
@ 12,19 SAY "ฬอออออออออออออฮอออออออออน"
@ 13,19 SAY "ฬอออออออออออออฮอออออออออน"
@ 14,19 SAY "บ     TOTALE  บ         บ"
@ 15,19 SAY "ฬอออออออออออออฮอออออออออฮออออออออออออออออป"
@ 16,19 SAY "บ    VENDUTO  บ         บPERC.VEND.     %บ"
@ 17,19 SAY "ฬอออออออออออออฮอออออออออฮออออออออออออออออน"
@ 18,19 SAY "บ   GIACENZA  บ         บPERC.GIAC.     %บ"
@ 19,19 SAY "ศอออออออออออออสอออออออออสออออออออออออออออผ"
@ 9,35 SAY LTRIM(STR(V4))
@ 11,35 SAY LTRIM(STR(V1))
@ 14,35 SAY LTRIM(STR(V5))
@ 16,35 SAY LTRIM(STR(V2))
@ 16,54 SAY LTRIM(STR(V7))
@ 18,35 SAY LTRIM(STR(V3))
@ 18,54 SAY LTRIM(STR(V8))
*** FINE MAS ***

@ 22, 0 SAY "BATTI UN TASTO QUALSIASI PER FINIRE"
WAIT ""
@ 24,0 SAY"CONTINUI ?"
@ 24,12 GET ANC 
READ
ENDDO
CLOSE ALL
CLEAR
RETURN


