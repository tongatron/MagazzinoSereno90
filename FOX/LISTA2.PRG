*  FILE NAME: LISTA2.PRG
*  BY: MAX BINDI
*  DATE: October 4, 1989
ALIST = DATE()
* LISTA2
STOR "0" TO LI
CLEA 
ANNOCOR = 1991
PREC="P"
@  1,1  SAY DATE()
@  1,32 SAY "LISTE   CARICHI"
@  1,73 SAY "LISTA2"
@  2,32 SAY "==============="
@  6,32 SAY "0 - FINE LAVORO"
@  7,32 SAY "1 - LC1 (ELENCO GENERALE)"
@ 08,32 SAY "2 - LC2 (ELENCO INCOMPLETI)"
@ 11,32 SAY "5 - LISTA A VIDEO ARCHIVIO STORICO"
@ 09,32 SAY "3 - LC3 (ELENCO ARCHIVIO STORICO)"
@ 10,32 SAY "4 - LISTA A VIDEO ARHIVIO CORRENTE"
@ 12,32 SAY "6 - CALCOLO VALORE ANNO A RICHIESTA" 
@ 13,32 SAY "7 - STAMPA VALORE ANNO A RICHIESTA"
@ 14,32 SAY "8 - LISTA CARICHI SELEZIONATE" 
USE CARICHI INDE PROCAR
@ 21,32 SAY "SCEGLI LISTA " GET LI PICT "9"
READ 
DO CASE 
CASE LI ="1"
   REPO FORM LC1 NOEJ TO PRIN FOR .NOT. FQ .AND. .NOT.FV
CASE LI = "2"
   REPO FORM LC1 HEAD "INCOMPLETI";
   NOEJ TO PRIN FOR FQ .AND. .NOT. FV
CASE LI = "5"
   USE PROGCAR INDE CODPRO
      BROW 
CASE LI = "3"
   @ 20,32 SAY "ULTIMA DATA DA LISTARE  " GET ALIST
   READ 
   USE PROGCAR INDE CODPRO
   REPO FORM LC3 NOEJ TO PRIN FOR DATC <= ALIST
CASE LI = "4"
   USE CARICHI INDE PROCAR
      BROW 
CASE LI = "6"
   @ 16,10 SAY "ANNO DA TRATTARE (AAAA) " GET ANNOCOR PICT "9999"
   READ 
   USE VALCAR
   SET SAFE OFF 
      ZAP 
      APPE FROM PROGCAR FOR YEAR(DATC)=ANNOCOR
   GO TOP 
   DO WHIL .NOT.EOF()
         REPL VALORE WITH QUANT*COSTO,CODICE WITH FORNI+CANALE
      SKIP 
   ENDD 
      SORT TO VALCAR2 ON CODICE
      ZAP 
   USE VALCAR2
      TOTA ON CODICE TO VALCAR3 FIEL VALORE
      ZAP 
   * RELEASE YN
CASE LI = "7"
   USE VALCAR3
   REPO FORM PRTCAROL NOEJ TO PRIN 
CASE LI = "8"
   DO CARSCE
ENDC 
CLEA
flush 
RETU 
