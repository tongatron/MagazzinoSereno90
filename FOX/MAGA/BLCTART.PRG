SET STAT OFF
SET TALK OFF
RELE ALL
STORE 'S' TO ANC
DO WHIL ANC = 'S'
CLEAR
STORE 'S' TO ANC
@  1,  3  SAY "CALCOLO VALORI INVENTARIO-ACQUISTI-TOTALE-VENDUTO-RIMANENZE SU INVENTARI"
@  4, 22  SAY "VUOI USARE IL MAGAZZINO DELL'ANNO"
@  5, 22  SAY "---------------------------------"
@  0,  1  TO  2, 77    DOUBLE
@  6,  8  TO  8, 21  
@  6, 47  TO  8, 60  
SET MESSAGE TO 24
@  7, 11   PROMPT "IN CORSO";
 MESSAGE "EFFUTTUA I CALCOLI SUL MAGAZZINO DELL'ANNO CORRENTE"
@  7, 49   PROMPT "PRECEDENTE";
 MESSAGE "EFFETTUA I CALCOLI SUL MAGAZZINO DELL'ANNO PRECEDENTE"              
MENU TO SCE
DO CASE
 CASE SCE= 1
 INV="ARKIVIO"
 CASE SCE= 2
 INV="ARKIVOLD"
ENDCASE
@ 12, 23 SAY "INTRODUCI IL NOME DELLA DITTA"
@ 11, 22 TO 13, 53
STORE '   ' TO VPRD
@ 16, 36 GET VPRD
READ
IF VPRD='   '
RETURN
ENDIF
USE ANAGRAF INDEX CODISTR
    SEEK VPRD
IF EOF()
LOOP
ENDIF
STORE ANAGRAF->NOME TO VNOM
@ 18, 28 SAY VNOM
@ 20, 30 SAY "GIUSTO ?"
VARS='S'
@ 20, 41 GET VARS
READ
IF VARS ='N'
LOOP
ENDIF
@ 4, 0 CLEAR
SET ECHO OFF
*   SET COLOR TO W+/ ,G+*/GR
*@ 10,20 SAY "旼컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴커"
*@ 11,20 SAY ""
*ET COLOR TO W+*/ 
*@ 11,21 SAY "TRA 25 SECONDI LA RISPOSTA .. GRAZIE"
**SET COLOR TO W+/ 
*@ 11,57 SAY ""
*@ 12,20 SAY "읕컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴켸"
*SET COLOR TO W+/ , /W
*  SET COLOR TO 15/0, 0/7
*USE TOT
*SET SAFE OFF
*ZAP
*SET SAFE ON
*APPEND FROM &INV FOR PRD=VPRD
*SUM COSTO * GIACONT  TO V4
*SUM COSTO * PROGCAR  TO V1
*SUM COSTO * PROGSCA  TO V2
*SUM COSTO * GIADIN   TO V3
*STORE V4+V1 TO V5
*STORE (V2 * 100)/V5 TO V7
*STORE (V3 * 100)/V5 TO V8

*@ 22, 0 SAY "BATTI UN TASTO QUALSIASI PER FINIRE"
*WAIT ""
*@ 24,0 SAY"CONTINUI ?"
*@ 24,12 GET ANC 
*READ
*ENDDO
*CLOSE ALL
*CLEAR
*RETURN
USE BILANCIO
appe from arkivIO FOR PRD= VPRD
replace all valinvent with costo * giacont
replace all valgiac with costo* giadin
replace all valvend with costo * progsca
REPLACE ALL VALTOT WITH VALINVENT+CARVALOR
USE BILANC1
APPE FROM BILANCIO
USE BILANCIO
set safe off
ZAP
USE BILANC1
SORT ON CAT TO BILANC2
ZAP
USE BILANC2
TOTAL ON CAT TO BILFIN FIEL CARVALOR,VALINVENT,VALGIAC,VALTOT,VALVEND
USE
USE BILFIN
ERASE BILANC2.DBF
SORT ON VALVEND TO BILCATDF
USE BILCATDF
ERASE BILFIN.DBF
set safe on
*REPO FORM CATEGori to print
brow  fiel  CAT,valinvent,carvalor,valtot,valvend,valgiac

